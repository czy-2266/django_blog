{"ast":null,"code":"import \"core-js/modules/es.iterator.constructor.js\";\nimport \"core-js/modules/es.iterator.some.js\";\nimport { createRouter, createWebHistory } from 'vue-router';\nimport { useAuthStore } from './stores/auth';\nimport { ElMessage } from 'element-plus';\n\n// 导入组件\nimport UserLogin from './components/UserLogin.vue';\nimport UserRegister from './components/UserRegister.vue';\nimport UserProfile from './components/UserProfile.vue';\n// 博客相关组件\nimport BlogHome from './components/BlogHome.vue';\nimport ArticleList from './components/ArticleList.vue';\nimport ArticleEditor from './components/ArticleEditor.vue';\nimport ArticleDetail from './components/ArticleDetail.vue';\nimport SearchPage from './components/SearchPage.vue';\nimport AboutPage from './components/AboutPage.vue';\nimport ThemeDemo from './components/ThemeDemo.vue';\nconst routes = [{\n  path: '/',\n  redirect: '/home'\n}, {\n  path: '/login',\n  name: 'Login',\n  component: UserLogin,\n  meta: {\n    requiresGuest: true\n  }\n}, {\n  path: '/register',\n  name: 'Register',\n  component: UserRegister,\n  meta: {\n    requiresGuest: true\n  }\n}, {\n  path: '/home',\n  name: 'Home',\n  component: BlogHome\n  // 移除 requiresAuth，允许未登录访问\n}, {\n  path: '/articles',\n  name: 'ArticleList',\n  component: ArticleList\n  // 移除 requiresAuth，允许未登录访问\n}, {\n  path: '/articles/:id',\n  name: 'ArticleDetail',\n  component: ArticleDetail\n  // 移除 requiresAuth，允许未登录访问\n}, {\n  path: '/create',\n  name: 'ArticleCreate',\n  component: ArticleEditor,\n  meta: {\n    requiresAuth: true\n  } // 保持发表文章需要登录\n}, {\n  path: '/articles/edit/:id',\n  name: 'ArticleEdit',\n  component: ArticleEditor,\n  meta: {\n    requiresAuth: true\n  } // 保持编辑文章需要登录\n}, {\n  path: '/search',\n  name: 'Search',\n  component: SearchPage\n  // 移除 requiresAuth，允许未登录访问\n}, {\n  path: '/about',\n  name: 'About',\n  component: AboutPage\n  // 移除 requiresAuth，允许未登录访问\n}, {\n  path: '/profile',\n  name: 'Profile',\n  component: UserProfile,\n  meta: {\n    requiresAuth: true\n  } // 保持个人中心需要登录\n}, {\n  path: '/theme-demo',\n  name: 'ThemeDemo',\n  component: ThemeDemo,\n  meta: {\n    requiresAuth: true\n  } // 保持主题演示需要登录\n}];\nconst router = createRouter({\n  history: createWebHistory(),\n  routes\n});\n\n// 全局路由守卫\nrouter.beforeEach(async (to, from, next) => {\n  const authStore = useAuthStore();\n\n  // 如果有token但没有用户信息，尝试获取用户信息\n  if (authStore.token && !authStore.user) {\n    await authStore.initAuth();\n  }\n\n  // 检查是否需要认证\n  if (to.matched.some(record => record.meta.requiresAuth)) {\n    if (!authStore.isAuthenticated) {\n      ElMessage.warning('请先登录');\n      next({\n        path: '/login',\n        query: {\n          redirect: to.fullPath\n        } // 保存重定向地址\n      });\n    } else {\n      next();\n    }\n  }\n  // 检查是否只允许访客访问（仅登录和注册页面）\n  else if (to.matched.some(record => record.meta.requiresGuest)) {\n    if (authStore.isAuthenticated) {\n      next('/home'); // 已登录用户重定向到个人中心\n    } else {\n      next();\n    }\n  } else {\n    next(); // 允许访问不需要认证的页面\n  }\n});\nexport default router;","map":{"version":3,"names":["createRouter","createWebHistory","useAuthStore","ElMessage","UserLogin","UserRegister","UserProfile","BlogHome","ArticleList","ArticleEditor","ArticleDetail","SearchPage","AboutPage","ThemeDemo","routes","path","redirect","name","component","meta","requiresGuest","requiresAuth","router","history","beforeEach","to","from","next","authStore","token","user","initAuth","matched","some","record","isAuthenticated","warning","query","fullPath"],"sources":["/Users/a123/PythonProject/System/django_blog/frontend/src/router.js"],"sourcesContent":["import { createRouter, createWebHistory } from 'vue-router';\r\nimport { useAuthStore } from './stores/auth';\r\nimport { ElMessage } from 'element-plus';\r\n\r\n// 导入组件\r\nimport UserLogin from './components/UserLogin.vue';\r\nimport UserRegister from './components/UserRegister.vue';\r\nimport UserProfile from './components/UserProfile.vue';\r\n// 博客相关组件\r\nimport BlogHome from './components/BlogHome.vue';\r\nimport ArticleList from './components/ArticleList.vue';\r\nimport ArticleEditor from './components/ArticleEditor.vue';\r\nimport ArticleDetail from './components/ArticleDetail.vue';\r\nimport SearchPage from './components/SearchPage.vue';\r\nimport AboutPage from './components/AboutPage.vue';\r\nimport ThemeDemo from './components/ThemeDemo.vue';\r\n\r\nconst routes = [\r\n  {\r\n    path: '/',\r\n    redirect: '/home'\r\n  },\r\n  {\r\n    path: '/login',\r\n    name: 'Login',\r\n    component: UserLogin,\r\n    meta: { requiresGuest: true }\r\n  },\r\n  {\r\n    path: '/register',\r\n    name: 'Register', \r\n    component: UserRegister,\r\n    meta: { requiresGuest: true }\r\n  },\r\n  {\r\n    path: '/home',\r\n    name: 'Home',\r\n    component: BlogHome\r\n    // 移除 requiresAuth，允许未登录访问\r\n  },\r\n  {\r\n    path: '/articles',\r\n    name: 'ArticleList',\r\n    component: ArticleList\r\n    // 移除 requiresAuth，允许未登录访问\r\n  },\r\n  {\r\n    path: '/articles/:id',\r\n    name: 'ArticleDetail',\r\n    component: ArticleDetail\r\n    // 移除 requiresAuth，允许未登录访问\r\n  },\r\n  {\r\n    path: '/create',\r\n    name: 'ArticleCreate',\r\n    component: ArticleEditor,\r\n    meta: { requiresAuth: true }  // 保持发表文章需要登录\r\n  },\r\n  {\r\n    path: '/articles/edit/:id',\r\n    name: 'ArticleEdit',\r\n    component: ArticleEditor,\r\n    meta: { requiresAuth: true }  // 保持编辑文章需要登录\r\n  },\r\n  {\r\n    path: '/search',\r\n    name: 'Search',\r\n    component: SearchPage\r\n    // 移除 requiresAuth，允许未登录访问\r\n  },\r\n  {\r\n    path: '/about',\r\n    name: 'About',\r\n    component: AboutPage\r\n    // 移除 requiresAuth，允许未登录访问\r\n  },\r\n  {\r\n    path: '/profile',\r\n    name: 'Profile',\r\n    component: UserProfile,\r\n    meta: { requiresAuth: true }  // 保持个人中心需要登录\r\n  },\r\n  {\r\n    path: '/theme-demo',\r\n    name: 'ThemeDemo',\r\n    component: ThemeDemo,\r\n    meta: { requiresAuth: true }  // 保持主题演示需要登录\r\n  }\r\n];\r\n\r\nconst router = createRouter({\r\n  history: createWebHistory(),\r\n  routes,\r\n});\r\n\r\n// 全局路由守卫\r\nrouter.beforeEach(async (to, from, next) => {\r\n  const authStore = useAuthStore();\r\n  \r\n  // 如果有token但没有用户信息，尝试获取用户信息\r\n  if (authStore.token && !authStore.user) {\r\n    await authStore.initAuth();\r\n  }\r\n  \r\n  // 检查是否需要认证\r\n  if (to.matched.some(record => record.meta.requiresAuth)) {\r\n    if (!authStore.isAuthenticated) {\r\n      ElMessage.warning('请先登录');\r\n      next({\r\n        path: '/login',\r\n        query: { redirect: to.fullPath } // 保存重定向地址\r\n      });\r\n    } else {\r\n      next();\r\n    }\r\n  }\r\n  // 检查是否只允许访客访问（仅登录和注册页面）\r\n  else if (to.matched.some(record => record.meta.requiresGuest)) {\r\n    if (authStore.isAuthenticated) {\r\n      next('/home'); // 已登录用户重定向到个人中心\r\n    } else {\r\n      next();\r\n    }\r\n  }\r\n  else {\r\n    next(); // 允许访问不需要认证的页面\r\n  }\r\n});\r\n\r\nexport default router;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}